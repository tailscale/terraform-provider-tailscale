---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "tailscale_aws_external_id Resource - terraform-provider-tailscale"
subcategory: ""
description: |-
  The aws_external_id resource allows you to mint an AWS External ID that Tailscale can use to assume an AWS IAM role that you create for the purposes of allowing Tailscale to stream logs to your S3 bucket. See the logstream_configuration resource for more details.
---

# tailscale_aws_external_id (Resource)

The aws_external_id resource allows you to mint an AWS External ID that Tailscale can use to assume an AWS IAM role that you create for the purposes of allowing Tailscale to stream logs to your S3 bucket. See the logstream_configuration resource for more details.

## Example Usage

```terraform
resource "tailscale_aws_external_id" "prod" {}

resource "tailscale_logstream_configuration" "configuration_logs" {
  log_type               = "configuration"
  destination_type       = "s3"
  s3_bucket              = aws_s3_bucket.tailscale_logs.id
  s3_region              = "us-west-2"
  s3_authentication_type = "rolearn"
  s3_role_arn            = aws_iam_role.logs_writer.arn
  s3_external_id         = tailscale_aws_external_id.prod.external_id
}

resource "aws_iam_role" "logs_writer" {
  name               = "logs-writer"
  assume_role_policy = data.aws_iam_policy_document.tailscale_assume_role.json
}

resource "aws_iam_role_policy" "logs_writer" {
  role   = aws_iam_role.logs_writer.id
  policy = data.aws_iam_policy_document.logs_writer.json
}

data "aws_iam_policy_document" "tailscale_assume_role" {
  statement {
    actions = ["sts:AssumeRole"]
    principals {
      type = "AWS"
      identifiers = [tailscale_aws_external_id.prod.tailscale_aws_account_id]
    }
    condition {
      test     = "StringEquals"
      variable = "sts:ExternalId"
      values   = [tailscale_aws_external_id.prod.external_id]
    }
  }
}

data "aws_iam_policy_document" "logs_writer" {
  statement {
    effect = "Allow"
    actions = ["s3:*"]
    resources = [
      "arn:aws:s3:::example-bucket",
      "arn:aws:s3:::example-bucket/*"
    ]
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Read-Only

- `external_id` (String) The External ID that Tailscale will supply when assuming your role. You must reference this in your IAM role's trust policy. See https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_common-scenarios_third-party.html for more information on external IDs.
- `id` (String) The ID of this resource.
- `tailscale_aws_account_id` (String) The AWS account from which Tailscale will assume your role. You must reference this in your IAM role's trust policy. See https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_common-scenarios_third-party.html for more information on external IDs.
